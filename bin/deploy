#!/bin/bash

set -e

trap 'echo "Error: Script failed at line $LINENO"; exit 1;' ERR

# Check if platform argument is provided
PLATFORM=${1:-}

if [ -z "$PLATFORM" ]; then
    echo "Usage: ./bin/deploy <platform>"
    echo "Available platforms: azure, aws"
    echo ""
    echo "Or use platform-specific scripts directly:"
    echo "  ./bin/deploy-azure"
    echo "  ./bin/deploy-aws"
    exit 1
fi

# Validate platform
if [ "$PLATFORM" != "azure" ] && [ "$PLATFORM" != "aws" ]; then
    echo "‚ùå Invalid platform: $PLATFORM"
    echo "Available platforms: azure, aws"
    exit 1
fi

# Run platform-specific deployment
echo "üöÄ Deploying to $PLATFORM..."
./bin/deploy-$PLATFORM